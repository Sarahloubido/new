{"ast":null,"code":"import React,{useState,useRef}from'react';import axios from'axios';import Papa from'papaparse';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SpreadsheetManager=_ref=>{let{data,onUpdateText,loading}=_ref;const[downloadUrl,setDownloadUrl]=useState(null);const[uploadedData,setUploadedData]=useState([]);const[processingFile,setProcessingFile]=useState(false);const fileInputRef=useRef(null);const API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:5000';const generateSpreadsheet=async format=>{try{const response=await axios.post(`${API_BASE_URL}/api/spreadsheet/generate`,{data,format,filename:`text_review_${new Date().toISOString().split('T')[0]}`});if(response.data.success){const fullUrl=`${API_BASE_URL}${response.data.downloadUrl}`;setDownloadUrl(fullUrl);// Trigger download\nconst link=document.createElement('a');link.href=fullUrl;link.download=response.data.filename;document.body.appendChild(link);link.click();document.body.removeChild(link);}}catch(error){console.error('Failed to generate spreadsheet:',error);alert('Failed to generate spreadsheet. Please try again.');}};const downloadTemplate=async format=>{try{const response=await fetch(`${API_BASE_URL}/api/spreadsheet/template/${format}`);const blob=await response.blob();const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=`text_review_template.${format}`;document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(url);}catch(error){console.error('Failed to download template:',error);alert('Failed to download template. Please try again.');}};const handleFileUpload=async event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(!file)return;setProcessingFile(true);try{var _file$name$split$pop;const fileExtension=(_file$name$split$pop=file.name.split('.').pop())===null||_file$name$split$pop===void 0?void 0:_file$name$split$pop.toLowerCase();if(fileExtension==='csv'){// Handle CSV files\nconst text=await file.text();const result=Papa.parse(text,{header:true,skipEmptyLines:true});if(result.errors.length>0){throw new Error(`CSV parsing errors: ${result.errors.map(e=>e.message).join(', ')}`);}const updates=result.data.filter(row=>row.edited_text&&row.edited_text.trim()!=='').map(row=>({id:row.id,original_text:row.original_text,edited_text:row.edited_text,frame_name:row.frame_name,component_path:row.component_path}));setUploadedData(updates);}else if(fileExtension==='xlsx'){// Handle Excel files by uploading to server\nconst formData=new FormData();formData.append('file',file);const response=await axios.post(`${API_BASE_URL}/api/upload/spreadsheet`,formData,{headers:{'Content-Type':'multipart/form-data'}});if(response.data.success){const processResponse=await axios.post(`${API_BASE_URL}/api/spreadsheet/process`,{fileContent:response.data.content,format:response.data.format});if(processResponse.data.success){setUploadedData(processResponse.data.data);}}}else{throw new Error('Unsupported file format. Please upload CSV or Excel files.');}}catch(error){console.error('File processing error:',error);alert(error.message||'Failed to process uploaded file. Please try again.');}finally{setProcessingFile(false);if(fileInputRef.current){fileInputRef.current.value='';}}};const applyUpdates=()=>{if(uploadedData.length===0){alert('No updates found. Please upload a file with edited text.');return;}// Merge updates with original data\nconst updatedElements=data.map(original=>{const update=uploadedData.find(u=>u.id===original.id);return update?{...original,edited_text:update.edited_text}:original;});onUpdateText(updatedElements);};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"Spreadsheet Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Export for editing or upload your changes\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-3\",children:\"1. Export for Editing\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>generateSpreadsheet('csv'),className:\"flex items-center justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),\"Download CSV\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>generateSpreadsheet('xlsx'),className:\"flex items-center justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),\"Download Excel\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-xs text-gray-500\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Don't have data yet? Download templates:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2 mt-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>downloadTemplate('csv'),className:\"text-blue-600 hover:text-blue-800\",children:\"CSV Template\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>downloadTemplate('xlsx'),className:\"text-blue-600 hover:text-blue-800\",children:\"Excel Template\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 pt-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-3\",children:\"2. Upload Edited File\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center w-full\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center pt-5 pb-6\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8 mb-4 text-gray-500\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"})}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2 text-sm text-gray-500\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Click to upload\"}),\" your edited file\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"CSV or Excel files\"})]}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\".csv,.xlsx,.xls\",onChange:handleFileUpload,className:\"hidden\",disabled:processingFile})]})}),processingFile&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex items-center justify-center text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"}),\"Processing file...\"]}),uploadedData.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-green-50 border border-green-200 rounded-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-green-600 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 13l4 4L19 7\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-green-800\",children:[\"Found \",uploadedData.length,\" text updates\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-xs text-green-700\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Preview of changes:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"mt-1 space-y-1\",children:[uploadedData.slice(0,3).map((update,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"truncate\",children:[\"\\\"\",update.original_text,\"\\\" \\u2192 \\\"\",update.edited_text,\"\\\"\"]},index)),uploadedData.length>3&&/*#__PURE__*/_jsxs(\"li\",{className:\"text-green-600\",children:[\"...and \",uploadedData.length-3,\" more changes\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 pt-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-3\",children:\"3. Apply Updates\"}),/*#__PURE__*/_jsx(\"button\",{onClick:applyUpdates,disabled:loading||uploadedData.length===0,className:\"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}),\"Applying Updates...\"]}):`Apply ${uploadedData.length} Updates`}),uploadedData.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-xs text-gray-500 text-center\",children:\"Upload an edited file to enable updates\"})]})]})]});};export default SpreadsheetManager;","map":{"version":3,"names":["React","useState","useRef","axios","Papa","jsx","_jsx","jsxs","_jsxs","SpreadsheetManager","_ref","data","onUpdateText","loading","downloadUrl","setDownloadUrl","uploadedData","setUploadedData","processingFile","setProcessingFile","fileInputRef","API_BASE_URL","process","env","REACT_APP_API_URL","generateSpreadsheet","format","response","post","filename","Date","toISOString","split","success","fullUrl","link","document","createElement","href","download","body","appendChild","click","removeChild","error","console","alert","downloadTemplate","fetch","blob","url","window","URL","createObjectURL","revokeObjectURL","handleFileUpload","event","_event$target$files","file","target","files","_file$name$split$pop","fileExtension","name","pop","toLowerCase","text","result","parse","header","skipEmptyLines","errors","length","Error","map","e","message","join","updates","filter","row","edited_text","trim","id","original_text","frame_name","component_path","formData","FormData","append","headers","processResponse","fileContent","content","current","value","applyUpdates","updatedElements","original","update","find","u","className","children","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","ref","type","accept","onChange","disabled","slice","index"],"sources":["/workspace/src/components/SpreadsheetManager.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport axios from 'axios';\nimport Papa from 'papaparse';\nimport { TextElement, TextUpdate } from '../types';\n\ninterface SpreadsheetManagerProps {\n  data: TextElement[];\n  onUpdateText: (updates: TextElement[]) => void;\n  loading: boolean;\n}\n\nconst SpreadsheetManager: React.FC<SpreadsheetManagerProps> = ({\n  data,\n  onUpdateText,\n  loading\n}) => {\n  const [downloadUrl, setDownloadUrl] = useState<string | null>(null);\n  const [uploadedData, setUploadedData] = useState<TextUpdate[]>([]);\n  const [processingFile, setProcessingFile] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';\n\n  const generateSpreadsheet = async (format: 'csv' | 'xlsx') => {\n    try {\n      const response = await axios.post(`${API_BASE_URL}/api/spreadsheet/generate`, {\n        data,\n        format,\n        filename: `text_review_${new Date().toISOString().split('T')[0]}`\n      });\n\n      if (response.data.success) {\n        const fullUrl = `${API_BASE_URL}${response.data.downloadUrl}`;\n        setDownloadUrl(fullUrl);\n        \n        // Trigger download\n        const link = document.createElement('a');\n        link.href = fullUrl;\n        link.download = response.data.filename;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n      }\n    } catch (error) {\n      console.error('Failed to generate spreadsheet:', error);\n      alert('Failed to generate spreadsheet. Please try again.');\n    }\n  };\n\n  const downloadTemplate = async (format: 'csv' | 'xlsx') => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/spreadsheet/template/${format}`);\n      const blob = await response.blob();\n      \n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `text_review_template.${format}`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (error) {\n      console.error('Failed to download template:', error);\n      alert('Failed to download template. Please try again.');\n    }\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setProcessingFile(true);\n\n    try {\n      const fileExtension = file.name.split('.').pop()?.toLowerCase();\n      \n      if (fileExtension === 'csv') {\n        // Handle CSV files\n        const text = await file.text();\n        const result = Papa.parse(text, {\n          header: true,\n          skipEmptyLines: true\n        });\n\n        if (result.errors.length > 0) {\n          throw new Error(`CSV parsing errors: ${result.errors.map(e => e.message).join(', ')}`);\n        }\n\n        const updates = result.data\n          .filter((row: any) => row.edited_text && row.edited_text.trim() !== '')\n          .map((row: any) => ({\n            id: row.id,\n            original_text: row.original_text,\n            edited_text: row.edited_text,\n            frame_name: row.frame_name,\n            component_path: row.component_path\n          }));\n\n        setUploadedData(updates);\n      } else if (fileExtension === 'xlsx') {\n        // Handle Excel files by uploading to server\n        const formData = new FormData();\n        formData.append('file', file);\n\n        const response = await axios.post(`${API_BASE_URL}/api/upload/spreadsheet`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n\n        if (response.data.success) {\n          const processResponse = await axios.post(`${API_BASE_URL}/api/spreadsheet/process`, {\n            fileContent: response.data.content,\n            format: response.data.format\n          });\n\n          if (processResponse.data.success) {\n            setUploadedData(processResponse.data.data);\n          }\n        }\n      } else {\n        throw new Error('Unsupported file format. Please upload CSV or Excel files.');\n      }\n    } catch (error: any) {\n      console.error('File processing error:', error);\n      alert(error.message || 'Failed to process uploaded file. Please try again.');\n    } finally {\n      setProcessingFile(false);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  const applyUpdates = () => {\n    if (uploadedData.length === 0) {\n      alert('No updates found. Please upload a file with edited text.');\n      return;\n    }\n\n    // Merge updates with original data\n    const updatedElements = data.map(original => {\n      const update = uploadedData.find(u => u.id === original.id);\n      return update ? { ...original, edited_text: update.edited_text } : original;\n    });\n\n    onUpdateText(updatedElements);\n  };\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"px-6 py-4 border-b border-gray-200\">\n        <h3 className=\"text-lg font-medium text-gray-900\">\n          Spreadsheet Management\n        </h3>\n        <p className=\"text-sm text-gray-600 mt-1\">\n          Export for editing or upload your changes\n        </p>\n      </div>\n\n      <div className=\"p-6 space-y-6\">\n        {/* Export Section */}\n        <div>\n          <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n            1. Export for Editing\n          </h4>\n          <div className=\"grid grid-cols-2 gap-3\">\n            <button\n              onClick={() => generateSpreadsheet('csv')}\n              className=\"flex items-center justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\n            >\n              <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n              </svg>\n              Download CSV\n            </button>\n            <button\n              onClick={() => generateSpreadsheet('xlsx')}\n              className=\"flex items-center justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\n            >\n              <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n              </svg>\n              Download Excel\n            </button>\n          </div>\n          \n          <div className=\"mt-3 text-xs text-gray-500\">\n            <p>Don't have data yet? Download templates:</p>\n            <div className=\"flex space-x-2 mt-1\">\n              <button\n                onClick={() => downloadTemplate('csv')}\n                className=\"text-blue-600 hover:text-blue-800\"\n              >\n                CSV Template\n              </button>\n              <span>•</span>\n              <button\n                onClick={() => downloadTemplate('xlsx')}\n                className=\"text-blue-600 hover:text-blue-800\"\n              >\n                Excel Template\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Upload Section */}\n        <div className=\"border-t border-gray-200 pt-6\">\n          <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n            2. Upload Edited File\n          </h4>\n          \n          <div className=\"flex items-center justify-center w-full\">\n            <label className=\"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100\">\n              <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\n                <svg className=\"w-8 h-8 mb-4 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n                </svg>\n                <p className=\"mb-2 text-sm text-gray-500\">\n                  <span className=\"font-semibold\">Click to upload</span> your edited file\n                </p>\n                <p className=\"text-xs text-gray-500\">CSV or Excel files</p>\n              </div>\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\".csv,.xlsx,.xls\"\n                onChange={handleFileUpload}\n                className=\"hidden\"\n                disabled={processingFile}\n              />\n            </label>\n          </div>\n\n          {processingFile && (\n            <div className=\"mt-3 flex items-center justify-center text-sm text-gray-600\">\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n              Processing file...\n            </div>\n          )}\n\n          {uploadedData.length > 0 && (\n            <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-md\">\n              <div className=\"flex items-center\">\n                <svg className=\"w-4 h-4 text-green-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                </svg>\n                <span className=\"text-sm font-medium text-green-800\">\n                  Found {uploadedData.length} text updates\n                </span>\n              </div>\n              <div className=\"mt-2 text-xs text-green-700\">\n                <p>Preview of changes:</p>\n                <ul className=\"mt-1 space-y-1\">\n                  {uploadedData.slice(0, 3).map((update, index) => (\n                    <li key={index} className=\"truncate\">\n                      \"{update.original_text}\" → \"{update.edited_text}\"\n                    </li>\n                  ))}\n                  {uploadedData.length > 3 && (\n                    <li className=\"text-green-600\">\n                      ...and {uploadedData.length - 3} more changes\n                    </li>\n                  )}\n                </ul>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Apply Section */}\n        <div className=\"border-t border-gray-200 pt-6\">\n          <h4 className=\"text-sm font-medium text-gray-900 mb-3\">\n            3. Apply Updates\n          </h4>\n          <button\n            onClick={applyUpdates}\n            disabled={loading || uploadedData.length === 0}\n            className=\"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {loading ? (\n              <div className=\"flex items-center justify-center\">\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                Applying Updates...\n              </div>\n            ) : (\n              `Apply ${uploadedData.length} Updates`\n            )}\n          </button>\n          \n          {uploadedData.length === 0 && (\n            <p className=\"mt-2 text-xs text-gray-500 text-center\">\n              Upload an edited file to enable updates\n            </p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SpreadsheetManager;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}